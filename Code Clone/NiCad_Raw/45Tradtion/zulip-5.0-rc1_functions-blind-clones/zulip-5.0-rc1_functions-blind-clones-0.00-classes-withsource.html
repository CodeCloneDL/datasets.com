<html>
<head>
    <title>NiCad6 Clone Report</title>
    <style type="text/css">
        body {font-family:sans-serif;}
        table {background-color:white; border:0px; padding:0px; border-spacing:4px; width:auto; margin-left:30px; margin-right:auto;}
        td {background-color:rgba(192,212,238,0.8); border:0px; padding:8px; width:auto; vertical-align:top; border-radius:8px}
        pre {background-color:white; padding:4px;}
        a {color:darkblue;}
    </style>
</head>
<body>
<h2>NiCad6 Clone Report</h2>
<table>
<tr style="font-size:14pt">
<td><b>System:</b> &nbsp; zulip-5.0-rc1</td>
<td><b>Clone pairs:</b> &nbsp; 133</td>
<td><b>Clone classes:</b> &nbsp; 25</td>
</tr>
<tr style="font-size:12pt">
<td style="background-color:white">Clone type: &nbsp; 2</td>
<td style="background-color:white">Granularity: &nbsp; functions-blind</td>
<td style="background-color:white">Max diff threshold: &nbsp; 0%</td>
<td style="background-color:white">Clone size: &nbsp; 10 - 2500 lines</td>
<td style="background-color:white">Total functions-blind: &nbsp; 2151</td>
</tr>
</table>
<br>
<table style="width:1000px; border:2px solid lightgrey; border-radius:8px;">
<tr><td style="background-color:white">
<p style="font-size:14pt"><b>Class 1:</b> &nbsp; 2 fragments, nominal size 12 lines, similarity 100%</p>
<table cellpadding=4 border=2>
<tr>
<td width="auto">
<a onclick="javascript:ShowHide('frag33')" href="javascript:;">
zulip-5.0-rc1/tools/droplets/create.py: 44-57
</a>
<div class="mid" id="frag33" style="display:none"><pre>
def assert_github_user_exists(github_username: str) -&gt; bool:
    print(f"Checking to see if GitHub user {github_username} exists...")
    user_api_url = f"https://api.github.com/users/{github_username}"
    try:
        response = urllib.request.urlopen(user_api_url)
        json.load(response)
        print("...user exists!")
        return True
    except urllib.error.HTTPError as err:
        print(err)
        print(f"Does the GitHub user {github_username} exist?")
        sys.exit(1)


</pre></div>
</td>
<td width="auto">
<a onclick="javascript:ShowHide('frag35')" href="javascript:;">
zulip-5.0-rc1/tools/droplets/create.py: 77-90
</a>
<div class="mid" id="frag35" style="display:none"><pre>
def assert_user_forked_zulip_server_repo(username: str) -&gt; bool:
    print("Checking to see GitHub user has forked zulip/zulip...")
    apiurl_fork = f"https://api.github.com/repos/{username}/zulip"
    try:
        response = urllib.request.urlopen(apiurl_fork)
        json.load(response)
        print("...fork found!")
        return True
    except urllib.error.HTTPError as err:
        print(err)
        print(f"Has user {username} forked zulip/zulip?")
        sys.exit(1)


</pre></div>
</td>
</tr><tr>
</tr>
</table>
</td></tr>
</table>
<br>
<table style="width:1000px; border:2px solid lightgrey; border-radius:8px;">
<tr><td style="background-color:white">
<p style="font-size:14pt"><b>Class 2:</b> &nbsp; 2 fragments, nominal size 10 lines, similarity 100%</p>
<table cellpadding=4 border=2>
<tr>
<td width="auto">
<a onclick="javascript:ShowHide('frag182')" href="javascript:;">
zulip-5.0-rc1/zerver/migrations/0352_migrate_twenty_four_hour_time_to_realmuserdefault.py: 9-21
</a>
<div class="mid" id="frag182" style="display:none"><pre>
def migrate_twenty_four_hour_time_to_realmuserdefault(
    apps: StateApps, schema_editor: DatabaseSchemaEditor
) -&gt; None:
    RealmUserDefault = apps.get_model("zerver", "RealmUserDefault")
    realm_user_default_objects = RealmUserDefault.objects.exclude(
        twenty_four_hour_time=F("realm__default_twenty_four_hour_time")
    )
    for realm_user_default in realm_user_default_objects:
        realm = realm_user_default.realm
        realm_user_default.twenty_four_hour_time = realm.default_twenty_four_hour_time
        realm_user_default.save(update_fields=["twenty_four_hour_time"])


</pre></div>
</td>
<td width="auto">
<a onclick="javascript:ShowHide('frag183')" href="javascript:;">
zulip-5.0-rc1/zerver/migrations/0352_migrate_twenty_four_hour_time_to_realmuserdefault.py: 22-34
</a>
<div class="mid" id="frag183" style="display:none"><pre>
def reverse_migrate_twenty_four_hour_time_to_realmuserdefault(
    apps: StateApps, schema_editor: DatabaseSchemaEditor
) -&gt; None:
    RealmUserDefault = apps.get_model("zerver", "RealmUserDefault")
    realm_user_default_objects = RealmUserDefault.objects.exclude(
        realm__default_twenty_four_hour_time=F("twenty_four_hour_time")
    )
    for realm_user_default in realm_user_default_objects:
        realm = realm_user_default.realm
        realm.default_twenty_four_hour_time = realm_user_default.twenty_four_hour_time
        realm.save(update_fields=["default_twenty_four_hour_time"])


</pre></div>
</td>
</tr><tr>
</tr>
</table>
</td></tr>
</table>
<br>
<table style="width:1000px; border:2px solid lightgrey; border-radius:8px;">
<tr><td style="background-color:white">
<p style="font-size:14pt"><b>Class 3:</b> &nbsp; 2 fragments, nominal size 11 lines, similarity 100%</p>
<table cellpadding=4 border=2>
<tr>
<td width="auto">
<a onclick="javascript:ShowHide('frag199')" href="javascript:;">
zulip-5.0-rc1/zerver/migrations/0244_message_copy_pub_date_to_date_sent.py: 13-30
</a>
<div class="mid" id="frag199" style="display:none"><pre>
def sql_copy_pub_date_to_date_sent(id_range_lower_bound: int, id_range_upper_bound: int) -&gt; None:
    query = SQL(
        """
            UPDATE zerver_message
            SET date_sent = pub_date
            WHERE id BETWEEN %(lower_bound)s AND %(upper_bound)s
    """
    )
    with connection.cursor() as cursor:
        cursor.execute(
            query,
            {
                "lower_bound": id_range_lower_bound,
                "upper_bound": id_range_upper_bound,
            },
        )


</pre></div>
</td>
<td width="auto">
<a onclick="javascript:ShowHide('frag248')" href="javascript:;">
zulip-5.0-rc1/zerver/migrations/0239_usermessage_copy_id_to_bigint_id.py: 14-31
</a>
<div class="mid" id="frag248" style="display:none"><pre>
def sql_copy_id_to_bigint_id(id_range_lower_bound: int, id_range_upper_bound: int) -&gt; None:
    query = SQL(
        """
            UPDATE zerver_usermessage
            SET bigint_id = id
            WHERE id BETWEEN %(lower_bound)s AND %(upper_bound)s
    """
    )
    with connection.cursor() as cursor:
        cursor.execute(
            query,
            {
                "lower_bound": id_range_lower_bound,
                "upper_bound": id_range_upper_bound,
            },
        )


</pre></div>
</td>
</tr><tr>
</tr>
</table>
</td></tr>
</table>
<br>
<table style="width:1000px; border:2px solid lightgrey; border-radius:8px;">
<tr><td style="background-color:white">
<p style="font-size:14pt"><b>Class 4:</b> &nbsp; 2 fragments, nominal size 16 lines, similarity 100%</p>
<table cellpadding=4 border=2>
<tr>
<td width="auto">
<a onclick="javascript:ShowHide('frag200')" href="javascript:;">
zulip-5.0-rc1/zerver/migrations/0244_message_copy_pub_date_to_date_sent.py: 31-57
</a>
<div class="mid" id="frag200" style="display:none"><pre>
def copy_pub_date_to_date_sent(apps: StateApps, schema_editor: DatabaseSchemaEditor) -&gt; None:
    Message = apps.get_model("zerver", "Message")
    if not Message.objects.exists():
        # Nothing to do
        return

    first_uncopied_id = Message.objects.filter(date_sent__isnull=True).aggregate(Min("id"))[
        "id__min"
    ]
    # Note: the below id can fall in a segment
    # where date_sent = pub_date already, but it's not a big problem
    # this will just do some redundant UPDATEs.
    last_id = Message.objects.latest("id").id

    id_range_lower_bound = first_uncopied_id
    id_range_upper_bound = first_uncopied_id + BATCH_SIZE
    while id_range_upper_bound &lt;= last_id:
        sql_copy_pub_date_to_date_sent(id_range_lower_bound, id_range_upper_bound)
        id_range_lower_bound = id_range_upper_bound + 1
        id_range_upper_bound = id_range_lower_bound + BATCH_SIZE
        time.sleep(0.1)

    if last_id &gt; id_range_lower_bound:
        # Copy for the last batch.
        sql_copy_pub_date_to_date_sent(id_range_lower_bound, last_id)


</pre></div>
</td>
<td width="auto">
<a onclick="javascript:ShowHide('frag249')" href="javascript:;">
zulip-5.0-rc1/zerver/migrations/0239_usermessage_copy_id_to_bigint_id.py: 32-59
</a>
<div class="mid" id="frag249" style="display:none"><pre>
def copy_id_to_bigid(apps: StateApps, schema_editor: DatabaseSchemaEditor) -&gt; None:
    UserMessage = apps.get_model("zerver", "UserMessage")
    if not UserMessage.objects.exists():
        # Nothing to do
        return

    #  TODO: is  the below lookup fast enough, considering there's no index on bigint_id?
    first_uncopied_id = UserMessage.objects.filter(bigint_id__isnull=True).aggregate(Min("id"))[
        "id__min"
    ]
    # Note: the below id can fall in a segment
    # where bigint_id = id already, but it's not a big problem
    # this will just do some redundant UPDATEs.
    last_id = UserMessage.objects.latest("id").id

    id_range_lower_bound = first_uncopied_id
    id_range_upper_bound = first_uncopied_id + BATCH_SIZE
    while id_range_upper_bound &lt;= last_id:
        sql_copy_id_to_bigint_id(id_range_lower_bound, id_range_upper_bound)
        id_range_lower_bound = id_range_upper_bound + 1
        id_range_upper_bound = id_range_lower_bound + BATCH_SIZE
        time.sleep(0.1)

    if last_id &gt; id_range_lower_bound:
        # Copy for the last batch.
        sql_copy_id_to_bigint_id(id_range_lower_bound, last_id)


</pre></div>
</td>
</tr><tr>
</tr>
</table>
</td></tr>
</table>
<br>
<table style="width:1000px; border:2px solid lightgrey; border-radius:8px;">
<tr><td style="background-color:white">
<p style="font-size:14pt"><b>Class 5:</b> &nbsp; 2 fragments, nominal size 10 lines, similarity 100%</p>
<table cellpadding=4 border=2>
<tr>
<td width="auto">
<a onclick="javascript:ShowHide('frag211')" href="javascript:;">
zulip-5.0-rc1/zerver/migrations/0328_migrate_to_edit_topic_policy.py: 20-33
</a>
<div class="mid" id="frag211" style="display:none"><pre>
def reverse_migrate_to_edit_topic_policy(
    apps: StateApps, schema_editor: DatabaseSchemaEditor
) -&gt; None:
    Realm = apps.get_model("zerver", "Realm")
    Realm.POLICY_EVERYONE = 5
    Realm.POLICY_ADMINS_ONLY = 2
    Realm.objects.filter(edit_topic_policy=Realm.POLICY_ADMINS_ONLY).update(
        allow_community_topic_editing=False
    )
    Realm.objects.filter(edit_topic_policy=Realm.POLICY_EVERYONE).update(
        allow_community_topic_editing=True
    )


</pre></div>
</td>
<td width="auto">
<a onclick="javascript:ShowHide('frag245')" href="javascript:;">
zulip-5.0-rc1/zerver/migrations/0338_migrate_to_add_custom_emoji_policy.py: 22-35
</a>
<div class="mid" id="frag245" style="display:none"><pre>
def reverse_migrate_to_add_custom_emoji_policy(
    apps: StateApps, schema_editor: DatabaseSchemaEditor
) -&gt; None:
    Realm = apps.get_model("zerver", "Realm")
    Realm.ADD_CUSTOM_EMOJI_MEMBERS_ONLY = 1
    Realm.ADD_CUSTOM_EMOJI_ADMINS_ONLY = 2
    Realm.objects.filter(add_custom_emoji_policy=Realm.ADD_CUSTOM_EMOJI_MEMBERS_ONLY).update(
        add_emoji_by_admins_only=False
    )
    Realm.objects.filter(add_custom_emoji_policy=Realm.ADD_CUSTOM_EMOJI_ADMINS_ONLY).update(
        add_emoji_by_admins_only=True
    )


</pre></div>
</td>
</tr><tr>
</tr>
</table>
</td></tr>
</table>
<br>
<table style="width:1000px; border:2px solid lightgrey; border-radius:8px;">
<tr><td style="background-color:white">
<p style="font-size:14pt"><b>Class 6:</b> &nbsp; 2 fragments, nominal size 10 lines, similarity 100%</p>
<table cellpadding=4 border=2>
<tr>
<td width="auto">
<a onclick="javascript:ShowHide('frag240')" href="javascript:;">
zulip-5.0-rc1/zerver/migrations/0356_migrate_to_delete_own_message_policy.py: 8-21
</a>
<div class="mid" id="frag240" style="display:none"><pre>
def migrate_to_delete_own_message_policy(
    apps: StateApps, schema_editor: DatabaseSchemaEditor
) -&gt; None:
    Realm = apps.get_model("zerver", "Realm")
    Realm.POLICY_EVERYONE = 5
    Realm.POLICY_ADMINS_ONLY = 2
    Realm.objects.filter(allow_message_deleting=False).update(
        delete_own_message_policy=Realm.POLICY_ADMINS_ONLY
    )
    Realm.objects.filter(allow_message_deleting=True).update(
        delete_own_message_policy=Realm.POLICY_EVERYONE
    )


</pre></div>
</td>
<td width="auto">
<a onclick="javascript:ShowHide('frag244')" href="javascript:;">
zulip-5.0-rc1/zerver/migrations/0338_migrate_to_add_custom_emoji_policy.py: 8-21
</a>
<div class="mid" id="frag244" style="display:none"><pre>
def migrate_to_add_custom_emoji_policy(
    apps: StateApps, schema_editor: DatabaseSchemaEditor
) -&gt; None:
    Realm = apps.get_model("zerver", "Realm")
    Realm.ADD_CUSTOM_EMOJI_MEMBERS_ONLY = 1
    Realm.ADD_CUSTOM_EMOJI_ADMINS_ONLY = 2
    Realm.objects.filter(add_emoji_by_admins_only=False).update(
        add_custom_emoji_policy=Realm.ADD_CUSTOM_EMOJI_MEMBERS_ONLY
    )
    Realm.objects.filter(add_emoji_by_admins_only=True).update(
        add_custom_emoji_policy=Realm.ADD_CUSTOM_EMOJI_ADMINS_ONLY
    )


</pre></div>
</td>
</tr><tr>
</tr>
</table>
</td></tr>
</table>
<br>
<table style="width:1000px; border:2px solid lightgrey; border-radius:8px;">
<tr><td style="background-color:white">
<p style="font-size:14pt"><b>Class 7:</b> &nbsp; 3 fragments, nominal size 11 lines, similarity 100%</p>
<table cellpadding=4 border=2>
<tr>
<td width="auto">
<a onclick="javascript:ShowHide('frag417')" href="javascript:;">
zulip-5.0-rc1/zerver/lib/transfer.py: 35-47
</a>
<div class="mid" id="frag417" style="display:none"><pre>
def transfer_avatars_to_s3(processes: int) -&gt; None:
    users = list(UserProfile.objects.all())
    if processes == 1:
        for user in users:
            _transfer_avatar_to_s3(user)
    else:  # nocoverage
        connection.close()
        cache._cache.disconnect_all()
        with multiprocessing.Pool(processes) as p:
            for out in p.imap_unordered(_transfer_avatar_to_s3, users):
                pass


</pre></div>
</td>
<td width="auto">
<a onclick="javascript:ShowHide('frag421')" href="javascript:;">
zulip-5.0-rc1/zerver/lib/transfer.py: 94-104
</a>
<div class="mid" id="frag421" style="display:none"><pre>
def transfer_emoji_to_s3(processes: int) -&gt; None:
    realm_emojis = list(RealmEmoji.objects.filter())
    if processes == 1:
        for realm_emoji in realm_emojis:
            _transfer_emoji_to_s3(realm_emoji)
    else:  # nocoverage
        connection.close()
        cache._cache.disconnect_all()
        with multiprocessing.Pool(processes) as p:
            for out in p.imap_unordered(_transfer_emoji_to_s3, realm_emojis):
                pass
</pre></div>
</td>
<td width="auto">
<a onclick="javascript:ShowHide('frag419')" href="javascript:;">
zulip-5.0-rc1/zerver/lib/transfer.py: 65-77
</a>
<div class="mid" id="frag419" style="display:none"><pre>
def transfer_message_files_to_s3(processes: int) -&gt; None:
    attachments = list(Attachment.objects.all())
    if processes == 1:
        for attachment in attachments:
            _transfer_message_files_to_s3(attachment)
    else:  # nocoverage
        connection.close()
        cache._cache.disconnect_all()
        with multiprocessing.Pool(processes) as p:
            for out in p.imap_unordered(_transfer_message_files_to_s3, attachments):
                pass


</pre></div>
</td>
</tr><tr>
</tr>
</table>
</td></tr>
</table>
<br>
<table style="width:1000px; border:2px solid lightgrey; border-radius:8px;">
<tr><td style="background-color:white">
<p style="font-size:14pt"><b>Class 8:</b> &nbsp; 2 fragments, nominal size 21 lines, similarity 100%</p>
<table cellpadding=4 border=2>
<tr>
<td width="auto">
<a onclick="javascript:ShowHide('frag601')" href="javascript:;">
zulip-5.0-rc1/zerver/tests/test_email_mirror.py: 435-463
</a>
<div class="mid" id="frag601" style="display:none"><pre>
    def test_receive_stream_email_include_footer_success(self) -&gt; None:
        user_profile = self.example_user("hamlet")
        self.login_user(user_profile)
        self.subscribe(user_profile, "Denmark")
        stream = get_stream("Denmark", user_profile.realm)

        stream_to_address = encode_email_address(stream)
        parts = stream_to_address.split("@")
        parts[0] += "+include-footer"
        stream_to_address = "@".join(parts)

        text = """Test message
        --
        Footer"""

        incoming_valid_message = EmailMessage()
        incoming_valid_message.set_content(text)
        incoming_valid_message["Subject"] = "TestStreamEmailMessages subject"
        incoming_valid_message["From"] = self.example_email("hamlet")
        incoming_valid_message["To"] = stream_to_address
        incoming_valid_message["Reply-to"] = self.example_email("othello")

        process_message(incoming_valid_message)
        message = most_recent_message(user_profile)

        self.assertEqual(message.content, text)
        self.assertEqual(get_display_recipient(message.recipient), stream.name)
        self.assertEqual(message.topic_name(), incoming_valid_message["Subject"])

</pre></div>
</td>
<td width="auto">
<a onclick="javascript:ShowHide('frag602')" href="javascript:;">
zulip-5.0-rc1/zerver/tests/test_email_mirror.py: 464-495
</a>
<div class="mid" id="frag602" style="display:none"><pre>
    def test_receive_stream_email_include_quotes_success(self) -&gt; None:
        user_profile = self.example_user("hamlet")
        self.login_user(user_profile)
        self.subscribe(user_profile, "Denmark")
        stream = get_stream("Denmark", user_profile.realm)

        stream_to_address = encode_email_address(stream)
        parts = stream_to_address.split("@")
        parts[0] += "+include-quotes"
        stream_to_address = "@".join(parts)

        text = """Reply

        -----Original Message-----

        Quote"""

        incoming_valid_message = EmailMessage()
        incoming_valid_message.set_content(text)
        incoming_valid_message["Subject"] = "TestStreamEmailMessages subject"
        incoming_valid_message["From"] = self.example_email("hamlet")
        incoming_valid_message["To"] = stream_to_address
        incoming_valid_message["Reply-to"] = self.example_email("othello")

        process_message(incoming_valid_message)
        message = most_recent_message(user_profile)

        self.assertEqual(message.content, text)
        self.assertEqual(get_display_recipient(message.recipient), stream.name)
        self.assertEqual(message.topic_name(), incoming_valid_message["Subject"])


</pre></div>
</td>
</tr><tr>
</tr>
</table>
</td></tr>
</table>
<br>
<table style="width:1000px; border:2px solid lightgrey; border-radius:8px;">
<tr><td style="background-color:white">
<p style="font-size:14pt"><b>Class 9:</b> &nbsp; 2 fragments, nominal size 12 lines, similarity 100%</p>
<table cellpadding=4 border=2>
<tr>
<td width="auto">
<a onclick="javascript:ShowHide('frag689')" href="javascript:;">
zulip-5.0-rc1/zerver/tests/test_zcommand.py: 24-38
</a>
<div class="mid" id="frag689" style="display:none"><pre>
    def test_night_zcommand(self) -&gt; None:
        self.login("hamlet")
        user = self.example_user("hamlet")
        user.color_scheme = UserProfile.COLOR_SCHEME_LIGHT
        user.save()

        payload = dict(command="/night")
        result = self.client_post("/json/zcommand", payload)
        self.assert_json_success(result)
        self.assertIn("Changed to dark theme", result.json()["msg"])

        result = self.client_post("/json/zcommand", payload)
        self.assert_json_success(result)
        self.assertIn("still in dark theme", result.json()["msg"])

</pre></div>
</td>
<td width="auto">
<a onclick="javascript:ShowHide('frag690')" href="javascript:;">
zulip-5.0-rc1/zerver/tests/test_zcommand.py: 39-53
</a>
<div class="mid" id="frag690" style="display:none"><pre>
    def test_day_zcommand(self) -&gt; None:
        self.login("hamlet")
        user = self.example_user("hamlet")
        user.color_scheme = UserProfile.COLOR_SCHEME_NIGHT
        user.save()

        payload = dict(command="/day")
        result = self.client_post("/json/zcommand", payload)
        self.assert_json_success(result)
        self.assertIn("Changed to light theme", result.json()["msg"])

        result = self.client_post("/json/zcommand", payload)
        self.assert_json_success(result)
        self.assertIn("still in light theme", result.json()["msg"])

</pre></div>
</td>
</tr><tr>
</tr>
</table>
</td></tr>
</table>
<br>
<table style="width:1000px; border:2px solid lightgrey; border-radius:8px;">
<tr><td style="background-color:white">
<p style="font-size:14pt"><b>Class 10:</b> &nbsp; 2 fragments, nominal size 12 lines, similarity 100%</p>
<table cellpadding=4 border=2>
<tr>
<td width="auto">
<a onclick="javascript:ShowHide('frag691')" href="javascript:;">
zulip-5.0-rc1/zerver/tests/test_zcommand.py: 54-68
</a>
<div class="mid" id="frag691" style="display:none"><pre>
    def test_fluid_zcommand(self) -&gt; None:
        self.login("hamlet")
        user = self.example_user("hamlet")
        user.fluid_layout_width = False
        user.save()

        payload = dict(command="/fluid-width")
        result = self.client_post("/json/zcommand", payload)
        self.assert_json_success(result)
        self.assert_in_response("Changed to fluid-width mode!", result)

        result = self.client_post("/json/zcommand", payload)
        self.assert_json_success(result)
        self.assert_in_response("You are still in fluid width mode", result)

</pre></div>
</td>
<td width="auto">
<a onclick="javascript:ShowHide('frag692')" href="javascript:;">
zulip-5.0-rc1/zerver/tests/test_zcommand.py: 69-82
</a>
<div class="mid" id="frag692" style="display:none"><pre>
    def test_fixed_zcommand(self) -&gt; None:
        self.login("hamlet")
        user = self.example_user("hamlet")
        user.fluid_layout_width = True
        user.save()

        payload = dict(command="/fixed-width")
        result = self.client_post("/json/zcommand", payload)
        self.assert_json_success(result)
        self.assert_in_response("Changed to fixed-width mode!", result)

        result = self.client_post("/json/zcommand", payload)
        self.assert_json_success(result)
        self.assert_in_response("You are still in fixed width mode", result)
</pre></div>
</td>
</tr><tr>
</tr>
</table>
</td></tr>
</table>
<br>
<table style="width:1000px; border:2px solid lightgrey; border-radius:8px;">
<tr><td style="background-color:white">
<p style="font-size:14pt"><b>Class 11:</b> &nbsp; 5 fragments, nominal size 10 lines, similarity 100%</p>
<table cellpadding=4 border=2>
<tr>
<td width="auto">
<a onclick="javascript:ShowHide('frag695')" href="javascript:;">
zulip-5.0-rc1/zerver/tests/test_tutorial.py: 35-47
</a>
<div class="mid" id="frag695" style="display:none"><pre>
    def test_response_to_pm_for_app(self) -&gt; None:
        user = self.example_user("hamlet")
        bot = get_system_bot(settings.WELCOME_BOT, user.realm_id)
        messages = ["app", "Apps"]
        self.login_user(user)
        for content in messages:
            self.send_personal_message(user, bot, content)
            expected_response = (
                "You can [download](/apps) the [mobile and desktop apps](/apps). "
                "Zulip also works great in a browser."
            )
            self.assertEqual(most_recent_message(user).content, expected_response)

</pre></div>
</td>
<td width="auto">
<a onclick="javascript:ShowHide('frag697')" href="javascript:;">
zulip-5.0-rc1/zerver/tests/test_tutorial.py: 62-76
</a>
<div class="mid" id="frag697" style="display:none"><pre>
    def test_response_to_pm_for_theme(self) -&gt; None:
        user = self.example_user("hamlet")
        bot = get_system_bot(settings.WELCOME_BOT, user.realm_id)
        messages = ["theme", "Theme"]
        self.login_user(user)
        for content in messages:
            self.send_personal_message(user, bot, content)
            expected_response = (
                "Go to [Display settings](#settings/display-settings) "
                "to [switch between the light and dark themes](/help/dark-theme), "
                "[pick your favorite emoji theme](/help/emoji-and-emoticons#change-your-emoji-set), "
                "[change your language](/help/change-your-language), and make other tweaks to your Zulip experience."
            )
            self.assertEqual(most_recent_message(user).content, expected_response)

</pre></div>
</td>
<td width="auto">
<a onclick="javascript:ShowHide('frag701')" href="javascript:;">
zulip-5.0-rc1/zerver/tests/test_tutorial.py: 120-135
</a>
<div class="mid" id="frag701" style="display:none"><pre>
    def test_response_to_pm_for_formatting(self) -&gt; None:
        user = self.example_user("hamlet")
        bot = get_system_bot(settings.WELCOME_BOT, user.realm_id)
        messages = ["message formatting", "Formatting"]
        self.login_user(user)
        for content in messages:
            self.send_personal_message(user, bot, content)
            expected_response = (
                "Zulip uses [Markdown](/help/format-your-message-using-markdown), "
                "an intuitive format for **bold**, *italics*, bulleted lists, and more. "
                "Click [here](#message-formatting) for a cheat sheet.\n\n"
                "Check out our [messaging tips](/help/messaging-tips) to learn about emoji reactions, "
                "code blocks and much more!"
            )
            self.assertEqual(most_recent_message(user).content, expected_response)

</pre></div>
</td>
<td width="auto">
<a onclick="javascript:ShowHide('frag699')" href="javascript:;">
zulip-5.0-rc1/zerver/tests/test_tutorial.py: 91-105
</a>
<div class="mid" id="frag699" style="display:none"><pre>
    def test_response_to_pm_for_topic(self) -&gt; None:
        user = self.example_user("hamlet")
        bot = get_system_bot(settings.WELCOME_BOT, user.realm_id)
        messages = ["Topics", "topics"]
        self.login_user(user)
        for content in messages:
            self.send_personal_message(user, bot, content)
            expected_response = (
                "In Zulip, topics [tell you what a message is about](/help/streams-and-topics). "
                "They are light-weight subjects, very similar to the subject line of an email.\n\n"
                "Check out [Recent topics](#recent_topics) to see what's happening! "
                'You can return to this conversation by clicking "Private messages" in the upper left.'
            )
            self.assertEqual(most_recent_message(user).content, expected_response)

</pre></div>
</td>
<td width="auto">
<a onclick="javascript:ShowHide('frag696')" href="javascript:;">
zulip-5.0-rc1/zerver/tests/test_tutorial.py: 48-61
</a>
<div class="mid" id="frag696" style="display:none"><pre>
    def test_response_to_pm_for_edit(self) -&gt; None:
        user = self.example_user("hamlet")
        bot = get_system_bot(settings.WELCOME_BOT, user.realm_id)
        messages = ["profile", "Profile"]
        self.login_user(user)
        for content in messages:
            self.send_personal_message(user, bot, content)
            expected_response = (
                "Go to [Profile settings](#settings/profile) "
                "to add a [profile picture](/help/change-your-profile-picture) "
                "and edit your [profile information](/help/edit-your-profile)."
            )
            self.assertEqual(most_recent_message(user).content, expected_response)

</pre></div>
</td>
</tr><tr>
</tr>
</table>
</td></tr>
</table>
<br>
<table style="width:1000px; border:2px solid lightgrey; border-radius:8px;">
<tr><td style="background-color:white">
<p style="font-size:14pt"><b>Class 12:</b> &nbsp; 3 fragments, nominal size 10 lines, similarity 100%</p>
<table cellpadding=4 border=2>
<tr>
<td width="auto">
<a onclick="javascript:ShowHide('frag698')" href="javascript:;">
zulip-5.0-rc1/zerver/tests/test_tutorial.py: 77-90
</a>
<div class="mid" id="frag698" style="display:none"><pre>
    def test_response_to_pm_for_stream(self) -&gt; None:
        user = self.example_user("hamlet")
        bot = get_system_bot(settings.WELCOME_BOT, user.realm_id)
        messages = ["Streams", "streams", "channels"]
        self.login_user(user)
        for content in messages:
            self.send_personal_message(user, bot, content)
            expected_response = (
                "In Zulip, streams [determine who gets a message](/help/streams-and-topics). "
                "They are similar to channels in other chat apps.\n\n"
                "[Browse and subscribe to streams](#streams/all)."
            )
            self.assertEqual(most_recent_message(user).content, expected_response)

</pre></div>
</td>
<td width="auto">
<a onclick="javascript:ShowHide('frag700')" href="javascript:;">
zulip-5.0-rc1/zerver/tests/test_tutorial.py: 106-119
</a>
<div class="mid" id="frag700" style="display:none"><pre>
    def test_response_to_pm_for_shortcuts(self) -&gt; None:
        user = self.example_user("hamlet")
        bot = get_system_bot(settings.WELCOME_BOT, user.realm_id)
        messages = ["Keyboard shortcuts", "shortcuts", "Shortcuts"]
        self.login_user(user)
        for content in messages:
            self.send_personal_message(user, bot, content)
            expected_response = (
                "Zulip's [keyboard shortcuts](#keyboard-shortcuts) "
                "let you navigate the app quickly and efficiently.\n\n"
                "Press `?` any time to see a [cheat sheet](#keyboard-shortcuts)."
            )
            self.assertEqual(most_recent_message(user).content, expected_response)

</pre></div>
</td>
<td width="auto">
<a onclick="javascript:ShowHide('frag702')" href="javascript:;">
zulip-5.0-rc1/zerver/tests/test_tutorial.py: 136-151
</a>
<div class="mid" id="frag702" style="display:none"><pre>
    def test_response_to_pm_for_help(self) -&gt; None:
        user = self.example_user("hamlet")
        bot = get_system_bot(settings.WELCOME_BOT, user.realm_id)
        messages = ["help", "Help", "?"]
        self.login_user(user)
        for content in messages:
            self.send_personal_message(user, bot, content)
            expected_response = (
                "Here are a few messages I understand: "
                "`apps`, `profile`, `theme`, "
                "`streams`, `topics`, `message formatting`, `keyboard shortcuts`.\n\n"
                "Check out our [Getting started guide](/help/getting-started-with-zulip), "
                "or browse the [Help center](/help/) to learn more!"
            )
            self.assertEqual(most_recent_message(user).content, expected_response)

</pre></div>
</td>
</tr><tr>
</tr>
</table>
</td></tr>
</table>
<br>
<table style="width:1000px; border:2px solid lightgrey; border-radius:8px;">
<tr><td style="background-color:white">
<p style="font-size:14pt"><b>Class 13:</b> &nbsp; 2 fragments, nominal size 10 lines, similarity 100%</p>
<table cellpadding=4 border=2>
<tr>
<td width="auto">
<a onclick="javascript:ShowHide('frag860')" href="javascript:;">
zulip-5.0-rc1/zerver/webhooks/librato/tests.py: 29-39
</a>
<div class="mid" id="frag860" style="display:none"><pre>
    def test_alert_message_with_custom_topic(self) -&gt; None:
        custom_topic = "custom_name"
        self.url = self.build_webhook_url(topic=custom_topic)
        expected_message = "Alert [alert_name](https://metrics.librato.com/alerts#/6294535) has triggered! [Reaction steps](http://www.google.pl):\n * Metric `librato.cpu.percent.idle`, sum was below 44 by 300s, recorded at 2016-03-31 09:11:42 UTC.\n * Metric `librato.swap.swap.cached`, average was absent  by 300s, recorded at 2016-03-31 09:11:42 UTC.\n * Metric `librato.swap.swap.cached`, derivative was above 9 by 300s, recorded at 2016-03-31 09:11:42 UTC."
        self.check_webhook(
            "alert",
            custom_topic,
            expected_message,
            content_type="application/x-www-form-urlencoded",
        )

</pre></div>
</td>
<td width="auto">
<a onclick="javascript:ShowHide('frag1678')" href="javascript:;">
zulip-5.0-rc1/zerver/webhooks/helloworld/tests.py: 64-75
</a>
<div class="mid" id="frag1678" style="display:none"><pre>
    def test_custom_topic(self) -&gt; None:
        # Note that this is really just a test for check_send_webhook_message
        expected_topic = "Custom Topic"
        self.url = self.build_webhook_url(topic=expected_topic)
        expected_message = "Hello! I am happy to be here! :smile:\nThe Wikipedia featured article for today is **[Goodbye](https://en.wikipedia.org/wiki/Goodbye)**"

        self.check_webhook(
            "goodbye",
            expected_topic,
            expected_message,
            content_type="application/x-www-form-urlencoded",
        )
</pre></div>
</td>
</tr><tr>
</tr>
</table>
</td></tr>
</table>
<br>
<table style="width:1000px; border:2px solid lightgrey; border-radius:8px;">
<tr><td style="background-color:white">
<p style="font-size:14pt"><b>Class 14:</b> &nbsp; 3 fragments, nominal size 12 lines, similarity 100%</p>
<table cellpadding=4 border=2>
<tr>
<td width="auto">
<a onclick="javascript:ShowHide('frag1102')" href="javascript:;">
zulip-5.0-rc1/zerver/webhooks/freshstatus/tests.py: 192-208
</a>
<div class="mid" id="frag1102" style="display:none"><pre>
    def test_freshstatus_invalid_payload_with_missing_data(self) -&gt; None:
        """
        Tests if invalid Freshstatus payloads are handled correctly
        """
        self.url = self.build_webhook_url()
        payload = self.get_body("freshstatus_invalid_payload_with_missing_data")
        result = self.client_post(self.url, payload, content_type="application/json")
        self.assert_json_error(result, "Invalid payload")

        expected_message = MISCONFIGURED_PAYLOAD_ERROR_MESSAGE.format(
            bot_name=self.test_user.full_name,
            support_email=FromAddress.SUPPORT,
        ).strip()

        msg = self.get_last_message()
        self.assertEqual(msg.content, expected_message)
        self.assertEqual(msg.recipient.type, Recipient.PERSONAL)
</pre></div>
</td>
<td width="auto">
<a onclick="javascript:ShowHide('frag1301')" href="javascript:;">
zulip-5.0-rc1/zerver/webhooks/uptimerobot/tests.py: 31-47
</a>
<div class="mid" id="frag1301" style="display:none"><pre>
    def test_uptimerobot_invalid_payload_with_missing_data(self) -&gt; None:
        """
        Tests if invalid UptimeRobot payloads are handled correctly
        """
        self.url = self.build_webhook_url()
        payload = self.get_body("uptimerobot_invalid_payload_with_missing_data")
        result = self.client_post(self.url, payload, content_type="application/json")
        self.assert_json_error(result, "Invalid payload")

        expected_message = MISCONFIGURED_PAYLOAD_ERROR_MESSAGE.format(
            bot_name=self.test_user.full_name,
            support_email=FromAddress.SUPPORT,
        ).strip()

        msg = self.get_last_message()
        self.assertEqual(msg.content, expected_message)
        self.assertEqual(msg.recipient.type, Recipient.PERSONAL)
</pre></div>
</td>
<td width="auto">
<a onclick="javascript:ShowHide('frag1980')" href="javascript:;">
zulip-5.0-rc1/zerver/webhooks/zabbix/tests.py: 20-36
</a>
<div class="mid" id="frag1980" style="display:none"><pre>
    def test_zabbix_invalid_payload_with_missing_data(self) -&gt; None:
        """
        Tests if invalid Zabbix payloads are handled correctly
        """
        self.url = self.build_webhook_url()
        payload = self.get_body("zabbix_invalid_payload_with_missing_data")
        result = self.client_post(self.url, payload, content_type="application/json")
        self.assert_json_error(result, "Invalid payload")

        expected_message = MISCONFIGURED_PAYLOAD_ERROR_MESSAGE.format(
            bot_name=self.test_user.full_name,
            support_email=FromAddress.SUPPORT,
        ).strip()

        msg = self.get_last_message()
        self.assertEqual(msg.content, expected_message)
        self.assertEqual(msg.recipient.type, Recipient.PERSONAL)
</pre></div>
</td>
</tr><tr>
</tr>
</table>
</td></tr>
</table>
<br>
<table style="width:1000px; border:2px solid lightgrey; border-radius:8px;">
<tr><td style="background-color:white">
<p style="font-size:14pt"><b>Class 15:</b> &nbsp; 6 fragments, nominal size 10 lines, similarity 100%</p>
<table cellpadding=4 border=2>
<tr>
<td width="auto">
<a onclick="javascript:ShowHide('frag1112')" href="javascript:;">
zulip-5.0-rc1/zerver/webhooks/splunk/tests.py: 10-30
</a>
<div class="mid" id="frag1112" style="display:none"><pre>
    def test_splunk_search_one_result(self) -&gt; None:
        self.url = self.build_webhook_url(topic="New Search Alert")

        # define the expected message contents
        expected_topic = "New Search Alert"
        expected_message = """
Splunk alert from saved search:
* **Search**: [sudo](http://example.com:8000/app/search/search?q=%7Cloadjob%20rt_scheduler__admin__search__sudo_at_1483557185_2.2%20%7C%20head%201%20%7C%20tail%201&amp;earliest=0&amp;latest=now)
* **Host**: myserver
* **Source**: `/var/log/auth.log`
* **Raw**: `Jan  4 11:14:32 myserver sudo: pam_unix(sudo:session): session closed for user root`
""".strip()

        # using fixture named splunk_search_one_result, execute this test
        self.check_webhook(
            "search_one_result",
            expected_topic,
            expected_message,
            content_type="application/x-www-form-urlencoded",
        )

</pre></div>
</td>
<td width="auto">
<a onclick="javascript:ShowHide('frag1116')" href="javascript:;">
zulip-5.0-rc1/zerver/webhooks/splunk/tests.py: 89-108
</a>
<div class="mid" id="frag1116" style="display:none"><pre>
    def test_splunk_missing_search_name(self) -&gt; None:

        self.url = self.build_webhook_url(topic="New Search Alert")

        expected_topic = "New Search Alert"
        expected_message = """
Splunk alert from saved search:
* **Search**: [Missing search_name](http://example.com:8000/app/search/search?q=%7Cloadjob%20rt_scheduler__admin__search__sudo_at_1483557185_2.2%20%7C%20head%201%20%7C%20tail%201&amp;earliest=0&amp;latest=now)
* **Host**: myserver
* **Source**: `/var/log/auth.log`
* **Raw**: `Jan  4 11:14:32 myserver sudo: pam_unix(sudo:session): session closed for user root`
""".strip()

        self.check_webhook(
            "missing_search_name",
            expected_topic,
            expected_message,
            content_type="application/x-www-form-urlencoded",
        )

</pre></div>
</td>
<td width="auto">
<a onclick="javascript:ShowHide('frag1115')" href="javascript:;">
zulip-5.0-rc1/zerver/webhooks/splunk/tests.py: 69-88
</a>
<div class="mid" id="frag1115" style="display:none"><pre>
    def test_splunk_missing_results_link(self) -&gt; None:

        self.url = self.build_webhook_url(topic="New Search Alert")

        expected_topic = "New Search Alert"
        expected_message = """
Splunk alert from saved search:
* **Search**: [sudo](Missing results_link)
* **Host**: myserver
* **Source**: `/var/log/auth.log`
* **Raw**: `Jan  4 11:14:32 myserver sudo: pam_unix(sudo:session): session closed for user root`
""".strip()

        self.check_webhook(
            "missing_results_link",
            expected_topic,
            expected_message,
            content_type="application/x-www-form-urlencoded",
        )

</pre></div>
</td>
</tr><tr>
<td width="auto">
<a onclick="javascript:ShowHide('frag1118')" href="javascript:;">
zulip-5.0-rc1/zerver/webhooks/splunk/tests.py: 129-148
</a>
<div class="mid" id="frag1118" style="display:none"><pre>
    def test_splunk_missing_source(self) -&gt; None:

        self.url = self.build_webhook_url(topic="New Search Alert")

        expected_topic = "New Search Alert"
        expected_message = """
Splunk alert from saved search:
* **Search**: [sudo](http://example.com:8000/app/search/search?q=%7Cloadjob%20rt_scheduler__admin__search__sudo_at_1483557185_2.2%20%7C%20head%201%20%7C%20tail%201&amp;earliest=0&amp;latest=now)
* **Host**: myserver
* **Source**: `Missing source`
* **Raw**: `Jan  4 11:14:32 myserver sudo: pam_unix(sudo:session): session closed for user root`
""".strip()

        self.check_webhook(
            "missing_source",
            expected_topic,
            expected_message,
            content_type="application/x-www-form-urlencoded",
        )

</pre></div>
</td>
<td width="auto">
<a onclick="javascript:ShowHide('frag1117')" href="javascript:;">
zulip-5.0-rc1/zerver/webhooks/splunk/tests.py: 109-128
</a>
<div class="mid" id="frag1117" style="display:none"><pre>
    def test_splunk_missing_host(self) -&gt; None:

        self.url = self.build_webhook_url(topic="New Search Alert")

        expected_topic = "New Search Alert"
        expected_message = """
Splunk alert from saved search:
* **Search**: [sudo](http://example.com:8000/app/search/search?q=%7Cloadjob%20rt_scheduler__admin__search__sudo_at_1483557185_2.2%20%7C%20head%201%20%7C%20tail%201&amp;earliest=0&amp;latest=now)
* **Host**: Missing host
* **Source**: `/var/log/auth.log`
* **Raw**: `Jan  4 11:14:32 myserver sudo: pam_unix(sudo:session): session closed for user root`
""".strip()

        self.check_webhook(
            "missing_host",
            expected_topic,
            expected_message,
            content_type="application/x-www-form-urlencoded",
        )

</pre></div>
</td>
<td width="auto">
<a onclick="javascript:ShowHide('frag1119')" href="javascript:;">
zulip-5.0-rc1/zerver/webhooks/splunk/tests.py: 149-167
</a>
<div class="mid" id="frag1119" style="display:none"><pre>
    def test_splunk_missing_raw(self) -&gt; None:

        self.url = self.build_webhook_url(topic="New Search Alert")

        expected_topic = "New Search Alert"
        expected_message = """
Splunk alert from saved search:
* **Search**: [sudo](http://example.com:8000/app/search/search?q=%7Cloadjob%20rt_scheduler__admin__search__sudo_at_1483557185_2.2%20%7C%20head%201%20%7C%20tail%201&amp;earliest=0&amp;latest=now)
* **Host**: myserver
* **Source**: `/var/log/auth.log`
* **Raw**: `Missing _raw`
""".strip()

        self.check_webhook(
            "missing_raw",
            expected_topic,
            expected_message,
            content_type="application/x-www-form-urlencoded",
        )
</pre></div>
</td>
</tr><tr>
</tr>
</table>
</td></tr>
</table>
<br>
<table style="width:1000px; border:2px solid lightgrey; border-radius:8px;">
<tr><td style="background-color:white">
<p style="font-size:14pt"><b>Class 16:</b> &nbsp; 4 fragments, nominal size 10 lines, similarity 100%</p>
<table cellpadding=4 border=2>
<tr>
<td width="auto">
<a onclick="javascript:ShowHide('frag1171')" href="javascript:;">
zulip-5.0-rc1/zerver/webhooks/bitbucket2/tests.py: 136-146
</a>
<div class="mid" id="frag1171" style="display:none"><pre>
    def test_bitbucket2_on_pull_request_created_with_custom_topic_in_url(self) -&gt; None:
        self.url = self.build_webhook_url(topic="notifications")
        expected_topic = "notifications"
        expected_message = "Tomasz created [PR #1 new commit](https://bitbucket.org/kolaszek/repository-name/pull-requests/1) (assigned to Tomasz Kolek) from `new-branch` to `master`:\n\n~~~ quote\ndescription\n~~~"
        self.check_webhook(
            "pull_request_created_or_updated",
            expected_topic,
            expected_message,
            HTTP_X_EVENT_KEY="pullrequest:created",
        )

</pre></div>
</td>
<td width="auto">
<a onclick="javascript:ShowHide('frag1179')" href="javascript:;">
zulip-5.0-rc1/zerver/webhooks/bitbucket2/tests.py: 214-224
</a>
<div class="mid" id="frag1179" style="display:none"><pre>
    def test_bitbucket2_on_pull_request_comment_created_with_custom_topic_in_url(self) -&gt; None:
        self.url = self.build_webhook_url(topic="notifications")
        expected_topic = "notifications"
        expected_message = "Tomasz [commented](https://bitbucket.org/kolaszek/repository-name/pull-requests/3/_/diff#comment-20576503) on [PR #1 new commit](https://bitbucket.org/kolaszek/repository-name/pull-requests/3):\n\n~~~ quote\nComment1\n~~~"
        self.check_webhook(
            "pull_request_comment_action",
            expected_topic,
            expected_message,
            HTTP_X_EVENT_KEY="pullrequest:comment_created",
        )

</pre></div>
</td>
<td width="auto">
<a onclick="javascript:ShowHide('frag1174')" href="javascript:;">
zulip-5.0-rc1/zerver/webhooks/bitbucket2/tests.py: 165-175
</a>
<div class="mid" id="frag1174" style="display:none"><pre>
    def test_bitbucket2_on_pull_request_approved_with_custom_topic_in_url(self) -&gt; None:
        self.url = self.build_webhook_url(topic="notifications")
        expected_topic = "notifications"
        expected_message = "Tomasz approved [PR #1 new commit](https://bitbucket.org/kolaszek/repository-name/pull-requests/1)."
        self.check_webhook(
            "pull_request_approved_or_unapproved",
            expected_topic,
            expected_message,
            HTTP_X_EVENT_KEY="pullrequest:approved",
        )

</pre></div>
</td>
<td width="auto">
<a onclick="javascript:ShowHide('frag1181')" href="javascript:;">
zulip-5.0-rc1/zerver/webhooks/bitbucket2/tests.py: 234-244
</a>
<div class="mid" id="frag1181" style="display:none"><pre>
    def test_bitbucket2_on_pull_request_comment_updated_with_custom_topic_in_url(self) -&gt; None:
        self.url = self.build_webhook_url(topic="notifications")
        expected_topic = "notifications"
        expected_message = "Tomasz updated a [comment](https://bitbucket.org/kolaszek/repository-name/pull-requests/3/_/diff#comment-20576503) on [PR #1 new commit](https://bitbucket.org/kolaszek/repository-name/pull-requests/3):\n\n~~~ quote\nComment1\n~~~"
        self.check_webhook(
            "pull_request_comment_action",
            expected_topic,
            expected_message,
            HTTP_X_EVENT_KEY="pullrequest:comment_updated",
        )

</pre></div>
</td>
</tr><tr>
</tr>
</table>
</td></tr>
</table>
<br>
<table style="width:1000px; border:2px solid lightgrey; border-radius:8px;">
<tr><td style="background-color:white">
<p style="font-size:14pt"><b>Class 17:</b> &nbsp; 2 fragments, nominal size 29 lines, similarity 100%</p>
<table cellpadding=4 border=2>
<tr>
<td width="auto">
<a onclick="javascript:ShowHide('frag1278')" href="javascript:;">
zulip-5.0-rc1/zerver/webhooks/clubhouse/tests.py: 217-248
</a>
<div class="mid" id="frag1278" style="display:none"><pre>
    def test_story_update_add_github_multiple_pull_requests(
        self, check_send_webhook_message_mock: MagicMock
    ) -&gt; None:
        payload = self.get_body("story_update_add_github_multiple_pull_requests")
        self.client_post(self.url, payload, content_type="application/json")
        expected_message = "New GitHub PR [#2](https://github.com/PIG208/test-clubhouse/pull/2) opened for story [{name}]({url}) (Unscheduled -&gt; In Development)."
        request, user_profile = (
            check_send_webhook_message_mock.call_args_list[0][0][0],
            check_send_webhook_message_mock.call_args_list[0][0][1],
        )
        expected_list = [
            call(
                request,
                user_profile,
                "Story1",
                expected_message.format(
                    name="Story1", url="https://app.clubhouse.io/pig208/story/17"
                ),
                "pull-request_create",
            ),
            call(
                request,
                user_profile,
                "Story2",
                expected_message.format(
                    name="Story2", url="https://app.clubhouse.io/pig208/story/18"
                ),
                "pull-request_create",
            ),
        ]
        self.assertEqual(check_send_webhook_message_mock.call_args_list, expected_list)

</pre></div>
</td>
<td width="auto">
<a onclick="javascript:ShowHide('frag1280')" href="javascript:;">
zulip-5.0-rc1/zerver/webhooks/clubhouse/tests.py: 258-289
</a>
<div class="mid" id="frag1280" style="display:none"><pre>
    def test_story_update_add_github_multiple_pull_requests_with_comment(
        self, check_send_webhook_message_mock: MagicMock
    ) -&gt; None:
        payload = self.get_body("story_update_add_github_multiple_pull_requests_with_comment")
        self.client_post(self.url, payload, content_type="application/json")
        expected_message = "Existing GitHub PR [#1](https://github.com/PIG208/test-clubhouse/pull/1) associated with story [{name}]({url}) (Unscheduled -&gt; In Development)."
        request, user_profile = (
            check_send_webhook_message_mock.call_args_list[0][0][0],
            check_send_webhook_message_mock.call_args_list[0][0][1],
        )
        expected_list = [
            call(
                request,
                user_profile,
                "new1",
                expected_message.format(
                    name="new1", url="https://app.clubhouse.io/pig208/story/26"
                ),
                "pull-request_comment",
            ),
            call(
                request,
                user_profile,
                "new2",
                expected_message.format(
                    name="new2", url="https://app.clubhouse.io/pig208/story/27"
                ),
                "pull-request_comment",
            ),
        ]
        self.assertEqual(check_send_webhook_message_mock.call_args_list, expected_list)

</pre></div>
</td>
</tr><tr>
</tr>
</table>
</td></tr>
</table>
<br>
<table style="width:1000px; border:2px solid lightgrey; border-radius:8px;">
<tr><td style="background-color:white">
<p style="font-size:14pt"><b>Class 18:</b> &nbsp; 12 fragments, nominal size 10 lines, similarity 100%</p>
<table cellpadding=4 border=2>
<tr>
<td width="auto">
<a onclick="javascript:ShowHide('frag1369')" href="javascript:;">
zulip-5.0-rc1/zerver/webhooks/front/tests.py: 25-40
</a>
<div class="mid" id="frag1369" style="display:none"><pre>
    def test_outbound_message(self) -&gt; None:
        expected_topic = "cnv_keo696"
        expected_message = (
            "[Outbound message](https://app.frontapp.com/open/msg_1176ie2) "
            "from **support@planet-express.com** "
            "to **calculon@momsbot.com**:\n"
            "```quote\n*Subject*: Your next delivery is on Epsilon 96Z\n```"
        )

        self.check_webhook(
            "outbound_message",
            expected_topic,
            expected_message,
            content_type="application/x-www-form-urlencoded",
        )

</pre></div>
</td>
<td width="auto">
<a onclick="javascript:ShowHide('frag2030')" href="javascript:;">
zulip-5.0-rc1/zerver/webhooks/stripe/tests.py: 88-99
</a>
<div class="mid" id="frag2030" style="display:none"><pre>
    def test_customer_deleted(self) -&gt; None:
        expected_topic = "cus_00000000000000"
        expected_message = (
            "[Customer](https://dashboard.stripe.com/customers/cus_00000000000000) deleted"
        )
        self.check_webhook(
            "customer_deleted",
            expected_topic,
            expected_message,
            content_type="application/x-www-form-urlencoded",
        )

</pre></div>
</td>
<td width="auto">
<a onclick="javascript:ShowHide('frag1379')" href="javascript:;">
zulip-5.0-rc1/zerver/webhooks/front/tests.py: 151-165
</a>
<div class="mid" id="frag1379" style="display:none"><pre>
    def test_outbound_reply(self) -&gt; None:
        expected_topic = "cnv_keocka"
        expected_message = (
            "[Outbound reply](https://app.frontapp.com/open/msg_1176ryy) "
            "from **support@planet-express.com** "
            "to **calculon@momsbot.com**."
        )

        self.check_webhook(
            "outbound_reply",
            expected_topic,
            expected_message,
            content_type="application/x-www-form-urlencoded",
        )

</pre></div>
</td>
</tr><tr>
<td width="auto">
<a onclick="javascript:ShowHide('frag1734')" href="javascript:;">
zulip-5.0-rc1/zerver/webhooks/wordpress/tests.py: 58-71
</a>
<div class="mid" id="frag1734" style="display:none"><pre>
    def test_user_register(self) -&gt; None:

        expected_topic = "New Blog Users"
        expected_message = (
            "New blog user registered:\n* **Name**: test_user\n* **Email**: test_user@example.com"
        )

        self.check_webhook(
            "user_register",
            expected_topic,
            expected_message,
            content_type="application/x-www-form-urlencoded",
        )

</pre></div>
</td>
<td width="auto">
<a onclick="javascript:ShowHide('frag2037')" href="javascript:;">
zulip-5.0-rc1/zerver/webhooks/stripe/tests.py: 180-191
</a>
<div class="mid" id="frag2037" style="display:none"><pre>
    def test_invoice_payment_failed(self) -&gt; None:
        expected_topic = "cus_00000000000000"
        expected_message = (
            "[Invoice](https://dashboard.stripe.com/invoices/in_00000000000000) payment failed"
        )
        self.check_webhook(
            "invoice_payment_failed",
            expected_topic,
            expected_message,
            content_type="application/x-www-form-urlencoded",
        )

</pre></div>
</td>
<td width="auto">
<a onclick="javascript:ShowHide('frag1376')" href="javascript:;">
zulip-5.0-rc1/zerver/webhooks/front/tests.py: 112-127
</a>
<div class="mid" id="frag1376" style="display:none"><pre>
    def test_inbound_message(self) -&gt; None:
        expected_topic = "cnv_keocka"
        expected_message = (
            "[Inbound message](https://app.frontapp.com/open/msg_1176r8y) "
            "from **calculon@momsbot.com** "
            "to **support@planet-express.com**:\n"
            "```quote\n*Subject*: Being a robot is great, but...\n```"
        )

        self.check_webhook(
            "inbound_message",
            expected_topic,
            expected_message,
            content_type="application/x-www-form-urlencoded",
        )

</pre></div>
</td>
</tr><tr>
<td width="auto">
<a onclick="javascript:ShowHide('frag1487')" href="javascript:;">
zulip-5.0-rc1/zerver/webhooks/gosquared/tests.py: 11-23
</a>
<div class="mid" id="frag1487" style="display:none"><pre>
    def test_traffic_message(self) -&gt; None:
        expected_topic = "GoSquared - requestb.in"
        expected_message = (
            "[requestb.in](https://www.gosquared.com/now/GSN-595854-T) has 33 visitors online."
        )

        self.check_webhook(
            "traffic_spike",
            expected_topic,
            expected_message,
            content_type="application/x-www-form-urlencoded",
        )

</pre></div>
</td>
<td width="auto">
<a onclick="javascript:ShowHide('frag2028')" href="javascript:;">
zulip-5.0-rc1/zerver/webhooks/stripe/tests.py: 66-77
</a>
<div class="mid" id="frag2028" style="display:none"><pre>
    def test_customer_created(self) -&gt; None:
        expected_topic = "cus_00000000000000"
        expected_message = (
            "[Customer](https://dashboard.stripe.com/customers/cus_00000000000000) created"
        )
        self.check_webhook(
            "customer_created",
            expected_topic,
            expected_message,
            content_type="application/x-www-form-urlencoded",
        )

</pre></div>
</td>
<td width="auto">
<a onclick="javascript:ShowHide('frag2032')" href="javascript:;">
zulip-5.0-rc1/zerver/webhooks/stripe/tests.py: 114-125
</a>
<div class="mid" id="frag2032" style="display:none"><pre>
    def test_customer_subscription_deleted(self) -&gt; None:
        expected_topic = "cus_00000000000000"
        expected_message = (
            "[Subscription](https://dashboard.stripe.com/subscriptions/sub_00000000000000) deleted"
        )
        self.check_webhook(
            "customer_subscription_deleted",
            expected_topic,
            expected_message,
            content_type="application/x-www-form-urlencoded",
        )

</pre></div>
</td>
</tr><tr>
<td width="auto">
<a onclick="javascript:ShowHide('frag1375')" href="javascript:;">
zulip-5.0-rc1/zerver/webhooks/front/tests.py: 96-111
</a>
<div class="mid" id="frag1375" style="display:none"><pre>
    def test_mention_all(self) -&gt; None:
        expected_topic = "cnv_keo696"
        expected_message = (
            "**Leela Turanga** left a comment:\n"
            "```quote\n@all Could someone else take this?\n```"
        )

        self.check_webhook(
            "mention_all",
            expected_topic,
            expected_message,
            content_type="application/x-www-form-urlencoded",
        )

    # Scenario 2: Conversation starts from an inbound message.

</pre></div>
</td>
<td width="auto">
<a onclick="javascript:ShowHide('frag1381')" href="javascript:;">
zulip-5.0-rc1/zerver/webhooks/front/tests.py: 177-190
</a>
<div class="mid" id="frag1381" style="display:none"><pre>
    def test_mention(self) -&gt; None:
        expected_topic = "cnv_keocka"
        expected_message = (
            "**Leela Turanga** left a comment:\n"
            "```quote\n@bender Could you take it from here?\n```"
        )

        self.check_webhook(
            "mention",
            expected_topic,
            expected_message,
            content_type="application/x-www-form-urlencoded",
        )

</pre></div>
</td>
<td width="auto">
<a onclick="javascript:ShowHide('frag2025')" href="javascript:;">
zulip-5.0-rc1/zerver/webhooks/stripe/tests.py: 32-44
</a>
<div class="mid" id="frag2025" style="display:none"><pre>
    def test_charge_failed(self) -&gt; None:
        expected_topic = "charges"
        expected_message = (
            "[Charge](https://dashboard.stripe.com/charges/ch_00000000000000) for 1.00 AUD failed"
        )
        self.check_webhook(
            "charge_failed",
            expected_topic,
            expected_message,
            content_type="application/x-www-form-urlencoded",
        )

    # Credit card charge
</pre></div>
</td>
</tr><tr>
</tr>
</table>
</td></tr>
</table>
<br>
<table style="width:1000px; border:2px solid lightgrey; border-radius:8px;">
<tr><td style="background-color:white">
<p style="font-size:14pt"><b>Class 19:</b> &nbsp; 2 fragments, nominal size 12 lines, similarity 100%</p>
<table cellpadding=4 border=2>
<tr>
<td width="auto">
<a onclick="javascript:ShowHide('frag1723')" href="javascript:;">
zulip-5.0-rc1/zerver/webhooks/newrelic/tests.py: 51-63
</a>
<div class="mid" id="frag1723" style="display:none"><pre>
    def test_not_recognized(self) -&gt; None:
        with self.assertRaises(AssertionError) as e:
            self.check_webhook(
                "incident_state_not_recognized",
                "",
                "",
                content_type="application/json",
            )
        self.assertIn(
            "The newrelic webhook requires current_state be in [open|acknowledged|closed]",
            e.exception.args[0],
        )

</pre></div>
</td>
<td width="auto">
<a onclick="javascript:ShowHide('frag1725')" href="javascript:;">
zulip-5.0-rc1/zerver/webhooks/newrelic/tests.py: 80-92
</a>
<div class="mid" id="frag1725" style="display:none"><pre>
    def test_missing_current_state(self) -&gt; None:
        with self.assertRaises(AssertionError) as e:
            self.check_webhook(
                "incident_missing_current_state",
                "",
                "",
                content_type="application/json",
            )
        self.assertIn(
            "The newrelic webhook requires current_state be in [open|acknowledged|closed]",
            e.exception.args[0],
        )

</pre></div>
</td>
</tr><tr>
</tr>
</table>
</td></tr>
</table>
<br>
<table style="width:1000px; border:2px solid lightgrey; border-radius:8px;">
<tr><td style="background-color:white">
<p style="font-size:14pt"><b>Class 20:</b> &nbsp; 3 fragments, nominal size 11 lines, similarity 100%</p>
<table cellpadding=4 border=2>
<tr>
<td width="auto">
<a onclick="javascript:ShowHide('frag1741')" href="javascript:;">
zulip-5.0-rc1/zerver/webhooks/deskdotcom/tests.py: 32-47
</a>
<div class="mid" id="frag1741" style="display:none"><pre>
    def test_case_updated_message(self) -&gt; None:
        expected_topic = "case updated notification"
        expected_message = (
            "Case 2 updated. "
            "Link: &lt;a href='https://deskdotcomtest.desk.com/web/agent/case/2'&gt;"
            "I have a question&lt;/a&gt;"
        )

        self.api_stream_message(
            self.test_user,
            "case_updated",
            expected_topic,
            expected_message,
            content_type="application/x-www-form-urlencoded",
        )

</pre></div>
</td>
<td width="auto">
<a onclick="javascript:ShowHide('frag1742')" href="javascript:;">
zulip-5.0-rc1/zerver/webhooks/deskdotcom/tests.py: 48-64
</a>
<div class="mid" id="frag1742" style="display:none"><pre>
    def test_unicode_text_italian(self) -&gt; None:

        expected_topic = "case updated notification"
        expected_message = (
            "Case 2 updated. "
            "Link: &lt;a href='https://deskdotcomtest.desk.com/web/agent/case/2'&gt;"
            "Il mio hovercraft è pieno di anguille.&lt;/a&gt;"
        )

        self.api_stream_message(
            self.test_user,
            "unicode_text_italian",
            expected_topic,
            expected_message,
            content_type="application/x-www-form-urlencoded",
        )

</pre></div>
</td>
<td width="auto">
<a onclick="javascript:ShowHide('frag1743')" href="javascript:;">
zulip-5.0-rc1/zerver/webhooks/deskdotcom/tests.py: 65-81
</a>
<div class="mid" id="frag1743" style="display:none"><pre>
    def test_unicode_text_japanese(self) -&gt; None:

        expected_topic = "case updated notification"
        expected_message = (
            "Case 2 updated. "
            "Link: &lt;a href='https://deskdotcomtest.desk.com/web/agent/case/2'&gt;"
            "私のホバークラフトは鰻でいっぱいです&lt;/a&gt;"
        )

        self.api_stream_message(
            self.test_user,
            "unicode_text_japanese",
            expected_topic,
            expected_message,
            content_type="application/x-www-form-urlencoded",
        )

</pre></div>
</td>
</tr><tr>
</tr>
</table>
</td></tr>
</table>
<br>
<table style="width:1000px; border:2px solid lightgrey; border-radius:8px;">
<tr><td style="background-color:white">
<p style="font-size:14pt"><b>Class 21:</b> &nbsp; 3 fragments, nominal size 10 lines, similarity 100%</p>
<table cellpadding=4 border=2>
<tr>
<td width="auto">
<a onclick="javascript:ShowHide('frag1801')" href="javascript:;">
zulip-5.0-rc1/zerver/webhooks/thinkst/tests.py: 154-176
</a>
<div class="mid" id="frag1801" style="display:none"><pre>
    def test_canary_with_specific_topic(self) -&gt; None:
        self.url = self.build_webhook_url(topic="foo")
        expected_message = (
            "**:alert: Canary *0000000testnode* has been triggered!**\n\n"
            "This is a dummy incident.\n\n"
            "**Incident ID:** `aa875f255f94e3ffe40dc85cf1a8b1e0`\n"
            "**Kind:** Dummy Incident\n"
            "**Timestamp:** 2020-06-09 13:59:38 (UTC)\n"
            "**Canary IP:** `1.1.1.1`\n"
            "**Source IP:** `2.2.2.2`\n"
            "**Reverse DNS:** `attacker-ip.local`\n"
            "**Field1:** VALUE1\n"
            "**Field2:** VALUE2\n"
            "**Field3:** VALUE3"
        )

        self.check_webhook(
            "canary_dummy",
            "foo",
            expected_message,
            content_type="application/x-www-form-urlencoded",
        )

</pre></div>
</td>
<td width="auto">
<a onclick="javascript:ShowHide('frag1813')" href="javascript:;">
zulip-5.0-rc1/zerver/webhooks/canarytoken/tests.py: 39-54
</a>
<div class="mid" id="frag1813" style="display:none"><pre>
    def test_canarytoken_with_specific_topic(self) -&gt; None:
        self.url = self.build_webhook_url(topic="foo")
        expected_message = (
            "**:alert: Canarytoken has been triggered on 2020-06-09 14:04:47 "
            "(UTC)!**\n\n"
            "Canarytoken example \n\n"
            "[Manage this canarytoken]"
            "(https://canarytokens.org/manage?token=foo&amp;auth=bar)"
        )

        self.check_webhook(
            "canarytoken_real",
            "foo",
            expected_message,
            content_type="application/x-www-form-urlencoded",
        )
</pre></div>
</td>
<td width="auto">
<a onclick="javascript:ShowHide('frag1804')" href="javascript:;">
zulip-5.0-rc1/zerver/webhooks/thinkst/tests.py: 234-260
</a>
<div class="mid" id="frag1804" style="display:none"><pre>
    def test_canarytoken_with_specific_topic(self) -&gt; None:
        self.url = self.build_webhook_url(topic="foo")
        expected_message = (
            "**:alert: Canarytoken *test document* has been triggered!**\n\n"
            "A MS Word .docx Document Canarytoken has been triggered over doc-msword "
            "by the source IP 1.1.1.1.\n\n"
            "**Incident ID:** `db6f9b5528c6c6c385cb3bb63f5949c8`\n"
            "**Token:** `dbwx4d68flwh2u5zku56nogu6`\n"
            "**Kind:** MS Word .docx Document\n"
            "**Timestamp:** 2020-07-20 14:40:15 (UTC)\n"
            "**Triggered:** 5 times\n"
            "**Accept:** `*/*`\n"
            "**Accept-Encoding:** gzip, deflate\n"
            "**Accept-Language:** en-gb\n"
            "**Background Context:** You have had 21 incidents from 1.1.1.1 "
            "previously.\n"
            "**Connection:** keep-alive\n"
            "**Dst Port:** 80\n"
            "**User-Agent:** Mozilla/4.0 (compatible; ms-office; MSOffice 16)"
        )

        self.check_webhook(
            "canarytoken_msword",
            "foo",
            expected_message,
            content_type="application/x-www-form-urlencoded",
        )
</pre></div>
</td>
</tr><tr>
</tr>
</table>
</td></tr>
</table>
<br>
<table style="width:1000px; border:2px solid lightgrey; border-radius:8px;">
<tr><td style="background-color:white">
<p style="font-size:14pt"><b>Class 22:</b> &nbsp; 2 fragments, nominal size 16 lines, similarity 100%</p>
<table cellpadding=4 border=2>
<tr>
<td width="auto">
<a onclick="javascript:ShowHide('frag1928')" href="javascript:;">
zulip-5.0-rc1/zerver/webhooks/gitlab/view.py: 218-236
</a>
<div class="mid" id="frag1928" style="display:none"><pre>
def get_commented_issue_event_body(payload: Dict[str, Any], include_title: bool = False) -&gt; str:
    comment = payload["object_attributes"]
    action = "[commented]({}) on".format(comment["url"])
    url = "{}/issues/{}".format(
        payload["project"].get("web_url"),
        payload["issue"].get("iid"),
    )

    return get_pull_request_event_message(
        get_issue_user_name(payload),
        action,
        url,
        payload["issue"].get("iid"),
        message=comment["note"],
        type="issue",
        title=payload["issue"].get("title") if include_title else None,
    )


</pre></div>
</td>
<td width="auto">
<a onclick="javascript:ShowHide('frag1929')" href="javascript:;">
zulip-5.0-rc1/zerver/webhooks/gitlab/view.py: 237-255
</a>
<div class="mid" id="frag1929" style="display:none"><pre>
def get_commented_snippet_event_body(payload: Dict[str, Any], include_title: bool = False) -&gt; str:
    comment = payload["object_attributes"]
    action = "[commented]({}) on".format(comment["url"])
    url = "{}/snippets/{}".format(
        payload["project"].get("web_url"),
        payload["snippet"].get("id"),
    )

    return get_pull_request_event_message(
        get_issue_user_name(payload),
        action,
        url,
        payload["snippet"].get("id"),
        message=comment["note"],
        type="snippet",
        title=payload["snippet"].get("title") if include_title else None,
    )


</pre></div>
</td>
</tr><tr>
</tr>
</table>
</td></tr>
</table>
<br>
<table style="width:1000px; border:2px solid lightgrey; border-radius:8px;">
<tr><td style="background-color:white">
<p style="font-size:14pt"><b>Class 23:</b> &nbsp; 4 fragments, nominal size 10 lines, similarity 100%</p>
<table cellpadding=4 border=2>
<tr>
<td width="auto">
<a onclick="javascript:ShowHide('frag1984')" href="javascript:;">
zulip-5.0-rc1/zerver/webhooks/freshdesk/tests.py: 11-36
</a>
<div class="mid" id="frag1984" style="display:none"><pre>
    def test_ticket_creation(self) -&gt; None:
        """
        Messages are generated on ticket creation through Freshdesk's
        "Dispatch'r" service.
        """
        expected_topic = "#11: Test ticket subject ☃"
        expected_message = """
Requester ☃ Bob &lt;requester-bob@example.com&gt; created [ticket #11](http://test1234zzz.freshdesk.com/helpdesk/tickets/11):

``` quote
Test ticket description ☃.
```

* **Type**: Incident
* **Priority**: High
* **Status**: Pending
""".strip()

        self.api_stream_message(
            self.test_user,
            "ticket_created",
            expected_topic,
            expected_message,
            content_type="application/x-www-form-urlencoded",
        )

</pre></div>
</td>
<td width="auto">
<a onclick="javascript:ShowHide('frag1986')" href="javascript:;">
zulip-5.0-rc1/zerver/webhooks/freshdesk/tests.py: 57-75
</a>
<div class="mid" id="frag1986" style="display:none"><pre>
    def test_priority_change(self) -&gt; None:
        """
        Messages are generated when a ticket's priority changes through
        Freshdesk's "Observer" service.
        """
        expected_topic = "#11: Test ticket subject"
        expected_message = """
Requester Bob &lt;requester-bob@example.com&gt; updated [ticket #11](http://test1234zzz.freshdesk.com/helpdesk/tickets/11):

* **Priority**: High -&gt; Low
""".strip()
        self.api_stream_message(
            self.test_user,
            "priority_changed",
            expected_topic,
            expected_message,
            content_type="application/x-www-form-urlencoded",
        )

</pre></div>
</td>
<td width="auto">
<a onclick="javascript:ShowHide('frag1991')" href="javascript:;">
zulip-5.0-rc1/zerver/webhooks/freshdesk/tests.py: 117-133
</a>
<div class="mid" id="frag1991" style="display:none"><pre>
    def test_inline_image(self) -&gt; None:
        """
        Freshdesk sends us descriptions as HTML, so we have to make the
        descriptions Zulip Markdown-friendly while still doing our best to
        preserve links and images.
        """
        expected_topic = "#12: Not enough ☃ guinea pigs"
        expected_message = """
Requester \u2603 Bob &lt;requester-bob@example.com&gt; created [ticket #12](http://test1234zzz.freshdesk.com/helpdesk/tickets/12):\n\n``` quote\nThere are too many cat pictures on the internet \u2603. We need more guinea pigs.\nExhibit 1:\n\n  \n\n[guinea_pig.png](http://cdn.freshdesk.com/data/helpdesk/attachments/production/12744808/original/guinea_pig.png)\n```\n\n* **Type**: Problem\n* **Priority**: Urgent\n* **Status**: Open
""".strip()
        self.api_stream_message(
            self.test_user,
            "inline_images",
            expected_topic,
            expected_message,
            content_type="application/x-www-form-urlencoded",
        )
</pre></div>
</td>
<td width="auto">
<a onclick="javascript:ShowHide('frag1985')" href="javascript:;">
zulip-5.0-rc1/zerver/webhooks/freshdesk/tests.py: 37-56
</a>
<div class="mid" id="frag1985" style="display:none"><pre>
    def test_status_change(self) -&gt; None:
        """
        Messages are generated when a ticket's status changes through
        Freshdesk's "Observer" service.
        """
        expected_topic = "#11: Test ticket subject ☃"
        expected_message = """
Requester Bob &lt;requester-bob@example.com&gt; updated [ticket #11](http://test1234zzz.freshdesk.com/helpdesk/tickets/11):

* **Status**: Resolved -&gt; Waiting on Customer
""".strip()

        self.api_stream_message(
            self.test_user,
            "status_changed",
            expected_topic,
            expected_message,
            content_type="application/x-www-form-urlencoded",
        )

</pre></div>
</td>
</tr><tr>
</tr>
</table>
</td></tr>
</table>
<br>
<table style="width:1000px; border:2px solid lightgrey; border-radius:8px;">
<tr><td style="background-color:white">
<p style="font-size:14pt"><b>Class 24:</b> &nbsp; 2 fragments, nominal size 10 lines, similarity 100%</p>
<table cellpadding=4 border=2>
<tr>
<td width="auto">
<a onclick="javascript:ShowHide('frag2019')" href="javascript:;">
zulip-5.0-rc1/zerver/webhooks/transifex/tests.py: 17-27
</a>
<div class="mid" id="frag2019" style="display:none"><pre>
    def test_transifex_reviewed_message(self) -&gt; None:
        expected_topic = f"{self.PROJECT} in {self.LANGUAGE}"
        expected_message = f"Resource {self.RESOURCE} fully reviewed."
        self.url = self.build_webhook_url(
            self.URL_REVIEWED_METHOD_TEMPLATE,
            project=self.PROJECT,
            language=self.LANGUAGE,
            resource=self.RESOURCE,
        )
        self.check_webhook("", expected_topic, expected_message)

</pre></div>
</td>
<td width="auto">
<a onclick="javascript:ShowHide('frag2020')" href="javascript:;">
zulip-5.0-rc1/zerver/webhooks/transifex/tests.py: 28-38
</a>
<div class="mid" id="frag2020" style="display:none"><pre>
    def test_transifex_translated_message(self) -&gt; None:
        expected_topic = f"{self.PROJECT} in {self.LANGUAGE}"
        expected_message = f"Resource {self.RESOURCE} fully translated."
        self.url = self.build_webhook_url(
            self.URL_TRANSLATED_METHOD_TEMPLATE,
            project=self.PROJECT,
            language=self.LANGUAGE,
            resource=self.RESOURCE,
        )
        self.check_webhook("", expected_topic, expected_message)

</pre></div>
</td>
</tr><tr>
</tr>
</table>
</td></tr>
</table>
<br>
<table style="width:1000px; border:2px solid lightgrey; border-radius:8px;">
<tr><td style="background-color:white">
<p style="font-size:14pt"><b>Class 25:</b> &nbsp; 2 fragments, nominal size 14 lines, similarity 100%</p>
<table cellpadding=4 border=2>
<tr>
<td width="auto">
<a onclick="javascript:ShowHide('frag2124')" href="javascript:;">
zulip-5.0-rc1/analytics/migrations/0009_remove_messages_to_stream_stat.py: 6-22
</a>
<div class="mid" id="frag2124" style="display:none"><pre>
def delete_messages_sent_to_stream_stat(
    apps: StateApps, schema_editor: DatabaseSchemaEditor
) -&gt; None:
    UserCount = apps.get_model("analytics", "UserCount")
    StreamCount = apps.get_model("analytics", "StreamCount")
    RealmCount = apps.get_model("analytics", "RealmCount")
    InstallationCount = apps.get_model("analytics", "InstallationCount")
    FillState = apps.get_model("analytics", "FillState")

    property = "messages_sent_to_stream:is_bot"
    UserCount.objects.filter(property=property).delete()
    StreamCount.objects.filter(property=property).delete()
    RealmCount.objects.filter(property=property).delete()
    InstallationCount.objects.filter(property=property).delete()
    FillState.objects.filter(property=property).delete()


</pre></div>
</td>
<td width="auto">
<a onclick="javascript:ShowHide('frag2125')" href="javascript:;">
zulip-5.0-rc1/analytics/migrations/0010_clear_messages_sent_values.py: 6-22
</a>
<div class="mid" id="frag2125" style="display:none"><pre>
def clear_message_sent_by_message_type_values(
    apps: StateApps, schema_editor: DatabaseSchemaEditor
) -&gt; None:
    UserCount = apps.get_model("analytics", "UserCount")
    StreamCount = apps.get_model("analytics", "StreamCount")
    RealmCount = apps.get_model("analytics", "RealmCount")
    InstallationCount = apps.get_model("analytics", "InstallationCount")
    FillState = apps.get_model("analytics", "FillState")

    property = "messages_sent:message_type:day"
    UserCount.objects.filter(property=property).delete()
    StreamCount.objects.filter(property=property).delete()
    RealmCount.objects.filter(property=property).delete()
    InstallationCount.objects.filter(property=property).delete()
    FillState.objects.filter(property=property).delete()


</pre></div>
</td>
</tr><tr>
</tr>
</table>
</td></tr>
</table>
<script language="JavaScript">
function ShowHide(divId) { 
    if(document.getElementById(divId).style.display == 'none') {
        document.getElementById(divId).style.display='block';
    } else { 
        document.getElementById(divId).style.display = 'none';
    } 
}
</script>
</body>
</html>
